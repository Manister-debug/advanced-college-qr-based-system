# توثيق مخطط قاعدة البيانات الشامل

## نظام إدارة الحضور بواسطة رموز QR

---

## 1. جدول Students (الطلاب)

**الغرض**: تخزين معلومات الطلاب الأساسية

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| UNI_ID | VARCHAR(12) | - | المفتاح الأساسي، رقم الطالب الجامعي الفريد |
| PASS | NVARCHAR(255) | - | كلمة المرور (يجب تشفيرها في الإنتاج) |
| Full_Name | VARCHAR(30) | 30 | الاسم الكامل للطالب |
| Phone_Number | VARCHAR(15) | 15 | رقم الهاتف (اختياري، فريد) |
| email | VARCHAR(35) | 35 | البريد الإلكتروني (فريد، مطلوب) |
| Branch | VARCHAR(30) | 30 | التخصص/الفرع (مثل علوم الحاسوب) |

**القيود**:
- PRIMARY KEY: UNI_ID
- UNIQUE: Phone_Number
- UNIQUE: email
- NOT NULL: UNI_ID, PASS, Full_Name, email, Branch

**مثال**:
```sql
INSERT INTO Students VALUES ('20230001', 'pass123', 'Ali Hassan', '0599000001', 'ali@example.com', 'Computer Science');
```

---

## 2. جدول lecturer (المحاضرون)

**الغرض**: تخزين معلومات المحاضرين والمدرسين

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| ID_lecturer | INT | - | المفتاح الأساسي، يزداد تلقائياً |
| Full_Name | VARCHAR(30) | 30 | الاسم الكامل للمحاضر |
| Specialization | VARCHAR(30) | 30 | التخصص (مثل الشبكات، البرمجة) |
| Role | VARCHAR(20) | 20 | الدور (أستاذ، محاضر، مساعد) |
| Phone_Number | VARCHAR(15) | 15 | رقم الهاتف (اختياري، فريد) |
| email | VARCHAR(35) | 35 | البريد الإلكتروني (فريد، مطلوب) |

**القيود**:
- PRIMARY KEY: ID_lecturer
- UNIQUE: Phone_Number
- UNIQUE: email
- NOT NULL: ID_lecturer, Full_Name, Specialization, Role, email

**مثال**:
```sql
INSERT INTO lecturer VALUES ('Dr. Mohammed Saleh', 'Networks', 'Professor', '0599111111', 'm.saleh@example.com');
```

---

## 3. جدول Courses (المقررات الدراسية)

**الغرض**: تخزين قائمة المقررات الدراسية

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| ID_course | VARCHAR(8) | 8 | المفتاح الأساسي، معرف المقرر (مثل CS101) |
| Cours_Name | VARCHAR(50) | 50 | اسم المقرر الكامل |
| Symbol_course | VARCHAR(6) | 6 | الرمز المختصر للمقرر |
| Credt_Hour | INT | - | عدد ساعات الائتمان |
| Courses_type | VARCHAR(3) | 3 | نوع المقرر (T=نظري، P=عملي، T,P=مختلط) |

**القيود**:
- PRIMARY KEY: ID_course
- CHECK: Courses_type IN ('T', 'P', 'T,P')
- NOT NULL: ID_course, Cours_Name, Symbol_course, Courses_type

**مثال**:
```sql
INSERT INTO Courses VALUES ('CS101', 'Introduction to Programming', 'PRG101', 3, 'T');
```

---

## 4. جدول Dean_of_colleges_Admin (عميد الكلية)

**الغرض**: تخزين معلومات المسؤولين الإداريين (عميد الكلية)

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| ID | INT | - | المفتاح الأساسي، يزداد تلقائياً |
| Full_Name | VARCHAR(30) | 30 | الاسم الكامل |
| Specialization | VARCHAR(30) | 30 | التخصص |
| Role | VARCHAR(10) | 10 | الدور (عميد، وكيل، إلخ) |
| Phone_Number | VARCHAR(15) | 15 | رقم الهاتف (اختياري، فريد) |
| email | VARCHAR(35) | 35 | البريد الإلكتروني (فريد، مطلوب) |

**القيود**:
- PRIMARY KEY: ID
- UNIQUE: Phone_Number
- UNIQUE: email
- NOT NULL: ID, Full_Name, Specialization, Role, email

---

## 5. جدول coordinators_Sub_Admin (منسقو الأقسام)

**الغرض**: تخزين معلومات منسقي الأقسام الفرعيين

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| ID | INT | - | المفتاح الأساسي، يزداد تلقائياً |
| Full_Name | VARCHAR(30) | 30 | الاسم الكامل |
| Specialization | VARCHAR(30) | 30 | التخصص |
| Role | VARCHAR(10) | 10 | الدور (منسق، مساعد، إلخ) |
| Phone_Number | VARCHAR(15) | 15 | رقم الهاتف (اختياري، فريد) |
| email | VARCHAR(35) | 35 | البريد الإلكتروني (فريد، مطلوب) |

**القيود**:
- PRIMARY KEY: ID
- UNIQUE: Phone_Number
- UNIQUE: email
- NOT NULL: ID, Full_Name, Specialization, Role, email

---

## 6. جدول Lecture_Time (أوقات المحاضرات)

**الغرض**: تخزين جدول المحاضرات والأوقات

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| Lecture_ID | INT | - | المفتاح الأساسي، يزداد تلقائياً |
| ID_course | VARCHAR(8) | 8 | معرف المقرر (مفتاح أجنبي) |
| ID_lecturer | INT | - | معرف المحاضر (مفتاح أجنبي) |
| Lecture_Date | DATE | - | تاريخ المحاضرة |
| Start_Time | TIME | - | وقت البداية |
| End_Time | TIME | - | وقت النهاية |

**القيود**:
- PRIMARY KEY: Lecture_ID
- FOREIGN KEY: ID_course → Courses(ID_course)
- FOREIGN KEY: ID_lecturer → lecturer(ID_lecturer)
- UNIQUE: (Lecture_Date, Start_Time, ID_course, ID_lecturer)
- CHECK: End_Time > Start_Time
- NOT NULL: Lecture_ID, ID_course, ID_lecturer

**مثال**:
```sql
INSERT INTO Lecture_Time VALUES ('CS101', 1, '2025-01-12', '09:00', '10:30');
```

---

## 7. جدول Name_Student_Cours (تسجيل الطلاب في المقررات)

**الغرض**: ربط الطلاب بالمقررات المسجلة فيها

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| UNI_ID | VARCHAR(12) | 12 | معرف الطالب (مفتاح أجنبي) |
| ID_course | VARCHAR(8) | 8 | معرف المقرر (مفتاح أجنبي) |

**القيود**:
- PRIMARY KEY: (UNI_ID, ID_course) - مفتاح مركب
- FOREIGN KEY: UNI_ID → Students(UNI_ID)
- FOREIGN KEY: ID_course → Courses(ID_course)
- NOT NULL: UNI_ID, ID_course

**مثال**:
```sql
INSERT INTO Name_Student_Cours VALUES ('20230001', 'CS101');
```

---

## 8. جدول Attendees_Name (سجلات الحضور)

**الغرض**: تسجيل حضور الطلاب في المحاضرات

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| UNI_ID | VARCHAR(12) | 12 | معرف الطالب (مفتاح أجنبي) |
| Lecture_ID | INT | - | معرف المحاضرة (مفتاح أجنبي) |

**القيود**:
- PRIMARY KEY: (UNI_ID, Lecture_ID) - مفتاح مركب
- FOREIGN KEY: UNI_ID → Students(UNI_ID)
- FOREIGN KEY: Lecture_ID → Lecture_Time(Lecture_ID)
- NOT NULL: UNI_ID, Lecture_ID

**مثال**:
```sql
INSERT INTO Attendees_Name VALUES ('20230001', 1);
```

---

## 9. جدول Users (حسابات المستخدمين)

**الغرض**: تخزين حسابات المستخدمين للنظام

| الحقل | النوع | الحد الأقصى | ملاحظات |
|------|------|----------|--------|
| User_ID | INT | - | المفتاح الأساسي، يزداد تلقائياً |
| Username | VARCHAR(30) | 30 | اسم المستخدم (فريد) |
| Password | NVARCHAR(255) | - | كلمة المرور (يجب تشفيرها) |
| Role | VARCHAR(10) | 10 | دور المستخدم (Admin, Lecturer, Coordinator, Dean) |

**القيود**:
- PRIMARY KEY: User_ID
- UNIQUE: Username
- NOT NULL: User_ID, Username, Password, Role

**مثال**:
```sql
INSERT INTO Users VALUES ('admin', 'admin123', 'Admin');
```

---

## العلاقات والمخطط البياني

```
┌─────────────────┐
│    Students     │
├─────────────────┤
│ UNI_ID (PK)     │
│ PASS            │
│ Full_Name       │
│ Phone_Number    │
│ email           │
│ Branch          │
└────────┬────────┘
         │
         ├──────────────────────────┐
         │                          │
         ▼                          ▼
┌──────────────────────┐   ┌─────────────────────┐
│ Name_Student_Cours   │   │  Attendees_Name     │
├──────────────────────┤   ├─────────────────────┤
│ UNI_ID (FK)          │   │ UNI_ID (FK)         │
│ ID_course (FK)       │   │ Lecture_ID (FK)     │
└──────────┬───────────┘   └──────────┬──────────┘
           │                          │
           ▼                          ▼
    ┌─────────────────┐      ┌──────────────────┐
    │    Courses      │      │   Lecture_Time   │
    ├─────────────────┤      ├──────────────────┤
    │ ID_course (PK)  │      │ Lecture_ID (PK)  │
    │ Cours_Name      │      │ ID_course (FK)   │
    │ Symbol_course   │      │ ID_lecturer (FK) │
    │ Credt_Hour      │      │ Lecture_Date     │
    │ Courses_type    │      │ Start_Time       │
    └─────────────────┘      │ End_Time         │
                             └──────────┬───────┘
                                        │
                                        ▼
                             ┌──────────────────┐
                             │    lecturer      │
                             ├──────────────────┤
                             │ ID_lecturer (PK) │
                             │ Full_Name        │
                             │ Specialization   │
                             │ Role             │
                             │ Phone_Number     │
                             │ email            │
                             └──────────────────┘

┌──────────────────────────────┐
│         Users                │
├──────────────────────────────┤
│ User_ID (PK)                 │
│ Username (UNIQUE)            │
│ Password                      │
│ Role (Admin/Lecturer/etc)    │
└──────────────────────────────┘

┌──────────────────────────────┐
│ Dean_of_colleges_Admin       │
├──────────────────────────────┤
│ ID (PK)                      │
│ Full_Name                    │
│ Specialization               │
│ Role                         │
│ Phone_Number                 │
│ email                        │
└──────────────────────────────┘

┌──────────────────────────────┐
│ coordinators_Sub_Admin       │
├──────────────────────────────┤
│ ID (PK)                      │
│ Full_Name                    │
│ Specialization               │
│ Role                         │
│ Phone_Number                 │
│ email                        │
└──────────────────────────────┘
```

---

## استعلامات مفيدة

### الحصول على حضور طالب معين
```sql
SELECT 
    s.Full_Name,
    c.Cours_Name,
    lt.Lecture_Date,
    lt.Start_Time
FROM Attendees_Name an
JOIN Students s ON an.UNI_ID = s.UNI_ID
JOIN Lecture_Time lt ON an.Lecture_ID = lt.Lecture_ID
JOIN Courses c ON lt.ID_course = c.ID_course
WHERE s.UNI_ID = '20230001'
ORDER BY lt.Lecture_Date;
```

### عدد الطلاب المسجلين في كل مقرر
```sql
SELECT 
    c.ID_course,
    c.Cours_Name,
    COUNT(nsc.UNI_ID) AS StudentCount
FROM Courses c
LEFT JOIN Name_Student_Cours nsc ON c.ID_course = nsc.ID_course
GROUP BY c.ID_course, c.Cours_Name;
```

### جدول المحاضرات مع معلومات المحاضر والمقرر
```sql
SELECT 
    lt.Lecture_ID,
    c.Cours_Name,
    l.Full_Name AS LecturerName,
    lt.Lecture_Date,
    lt.Start_Time,
    lt.End_Time
FROM Lecture_Time lt
JOIN Courses c ON lt.ID_course = c.ID_course
JOIN lecturer l ON lt.ID_lecturer = l.ID_lecturer
ORDER BY lt.Lecture_Date, lt.Start_Time;
```

### نسبة الحضور لكل طالب
```sql
SELECT 
    s.UNI_ID,
    s.Full_Name,
    COUNT(DISTINCT an.Lecture_ID) AS AttendanceCount,
    COUNT(DISTINCT nsc.ID_course) AS EnrolledCourses
FROM Students s
LEFT JOIN Name_Student_Cours nsc ON s.UNI_ID = nsc.UNI_ID
LEFT JOIN Attendees_Name an ON s.UNI_ID = an.UNI_ID
GROUP BY s.UNI_ID, s.Full_Name;
```

---

## ملاحظات مهمة

1. **الأمان**: كلمات المرور يجب أن تكون مشفرة في بيئة الإنتاج
2. **الأداء**: قد تحتاج إلى فهارس على المفاتيح الأجنبية الشائعة
3. **النسخ الاحتياطية**: قم بعمل نسخ احتياطية منتظمة
4. **الصيانة**: راقب نمو البيانات وقم بالتنظيف الدوري

---

**آخر تحديث**: 2025-01-12
